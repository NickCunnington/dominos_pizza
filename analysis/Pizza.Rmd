---
title: "R Notebook"
output: html_notebook
---


```{r}
library(readxl)
library(janitor)
library(tidyverse)
```


```{r}
pizza <- read_csv("clean_data/pizza_clean.csv")
```



```{r}
# Removing Gluten Free and Vegan pizzas as they don't have sizes and/or crusts
# types that compare to other pizzas.

pizza <- pizza %>%
  filter(name != "Gluten Free Pizzas" & name != "Vegan Pizza") 
```


*There are multiple entries for each pizza name, as there are up to 4 sizes of pizza and 4 different crust types.  This makes it a bit more difficult to plot.*

*However as not all crust types are available in all 4 sizes I shall just choose the "medium" size as my baseline for comparison between different crust types and pizza toppings.* 

*Although exploring this using values per 100g is a good way of normalising data for all the food types to a common baseline, it isn't really that easy for a person to immediately understand whether something is good or bad nutritionally, only how it compares to something else.  I shall therefore use the values per serving as a baseline.  And specifically use the percent of recommended daily allowance, rather than in grams, so it's easy to quickly judge the nutritional value of a dish compared to your RDA guidelines.*




# Crust Types


```{r}
# Working out average %RDA for each crust type (medium size)

crust_calories <- pizza %>%
  filter(size == "Medium") %>%
  group_by(crust) %>%
  summarise(avg_percent_RDA = round(mean(Calories),0))

crust_protein <- pizza %>%
  filter(size == "Medium") %>%
  group_by(crust) %>%
  summarise(avg_percent_RDA = round(mean(Protein),0))

crust_fat <- pizza %>%
  filter(size == "Medium") %>%
  group_by(crust) %>%
  summarise(avg_percent_RDA = round(mean(Fat),0))

crust_saturated <- pizza %>%
  filter(size == "Medium") %>%
  group_by(crust) %>%
  summarise(avg_percent_RDA = round(mean(Saturated),0))

crust_carbs <- pizza %>%
  filter(size == "Medium") %>%
  group_by(crust) %>%
  summarise(avg_percent_RDA = round(mean(Carbs),0))

crust_sugar <- pizza %>%
  filter(size == "Medium") %>%
  group_by(crust) %>%
  summarise(avg_percent_RDA = round(mean(Sugar),0))

crust_fibre <- pizza %>%
  filter(size == "Medium") %>%
  group_by(crust) %>%
  summarise(avg_percent_RDA = round(mean(Fibre),0))

crust_salt <- pizza %>%
  filter(size == "Medium") %>%
  group_by(crust) %>%
  summarise(avg_percent_RDA = round(mean(Salt),0))
```




### %RDA of Calories per Crust Type 

```{r}
crust_calories %>%
  ggplot() +
  aes(x = crust, y = avg_percent_RDA) +
  geom_col(fill = "darkblue") +
  geom_text(aes(label = paste0(avg_percent_RDA, "%")), hjust = 1.2, col = "white") +
  coord_flip() +
  xlab("Crust Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Calories per Crust Type (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14)) 
```



### %RDA of Protein per Crust Type


```{r}
crust_protein %>%
  ggplot() +
  aes(x = crust, y = avg_percent_RDA) +
  geom_col(fill = "darkblue") +
  coord_flip() +
  xlab("Crust Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Protein per Crust Type (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Fat per crust type

```{r}
crust_fat %>%
  ggplot() +
  aes(x = crust, y = avg_percent_RDA) +
  geom_col(fill = "darkblue") +
  coord_flip() +
  xlab("Crust Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Fat per Crust Type (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Saturated Fat per Crust Type


```{r}
crust_saturated %>%
  ggplot() +
  aes(x = crust, y = avg_percent_RDA) +
  geom_col(fill = "darkblue") +
  coord_flip() +
  xlab("Crust Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Saturated Fat per Crust Type (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Carbs per Crust Type

```{r}
crust_carbs %>%
  ggplot() +
  aes(x = crust, y = avg_percent_RDA) +
  geom_col(fill = "darkblue") +
  coord_flip() +
  xlab("Crust Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Carbs per Crust Type (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of sugars per Crust Type

```{r}
crust_sugar %>%
  ggplot() +
  aes(x = crust, y = avg_percent_RDA) +
  geom_col(fill = "darkblue") +
  coord_flip() +
  xlab("Crust Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Sugar per Crust Type (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Fibre per Crust Type


```{r}
crust_fibre %>%
  ggplot() +
  aes(x = crust, y = avg_percent_RDA) +
  geom_col(fill = "darkblue") +
  coord_flip() +
  xlab("Crust Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Fibre per Crust Type (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of salt per Crust Type

```{r}
crust_salt %>%
  ggplot() +
  aes(x = crust, y = avg_percent_RDA) +
  geom_col(fill = "darkblue") +
  coord_flip() +
  xlab("Crust Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Salt per Crust Type (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```





#  Pizza Toppings


```{r}
# Working out average %RDA per Pizza topping for all crust types combined (medium size)

pizza_calories <- pizza %>%
  filter(size == "Medium") %>%
  group_by(name) %>%
  summarise(Calories = round(mean(Calories)))

pizza_protein <- pizza %>%
  filter(size == "Medium") %>%
  group_by(name) %>%
  summarise(Protein = round(mean(Protein)))

pizza_fat <- pizza %>%
  filter(size == "Medium") %>%
  group_by(name) %>%
  summarise(Fat = round(mean(Fat)))

pizza_sat <- pizza %>%
  filter(size == "Medium") %>%
  group_by(name) %>%
  summarise(Saturated = round(mean(Saturated)))

pizza_carbs <- pizza %>%
  filter(size == "Medium") %>%
  group_by(name) %>%
  summarise(Carbs = round(mean(Carbs)))

pizza_sugar <- pizza %>%
  filter(size == "Medium") %>%
  group_by(name) %>%
  summarise(Sugar = round(mean(Sugar)))

pizza_fibre <- pizza %>%
  filter(size == "Medium") %>%
  group_by(name) %>%
  summarise(Fibre = round(mean(Fibre)))

pizza_salt <- pizza %>%
  filter(size == "Medium") %>%
  group_by(name) %>%
  summarise(Salt = round(mean(Salt)))

```


### %RDA of Calories per Pizza Topping

```{r}
pizza_calories %>%
  ggplot() +
  aes(reorder(x = name, Calories), y = Calories) +
  geom_col(fill = "darkblue", col = "white") +
  coord_flip() +
  xlab("Pizza Name\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Calories per Pizza Name (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Protein per Pizza Topping

```{r}
pizza_protein %>%
  ggplot() +
  aes(reorder(x = name, Protein), y = Protein) +
  geom_col(fill = "darkblue", col = "white") +
  coord_flip() +
  xlab("Pizza Name\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of protein per Pizza Name (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Fat per Pizza Topping


```{r}
pizza_fat %>%
  ggplot() +
  aes(reorder(x = name, Fat), y = Fat) +
  geom_col(fill = "darkblue", col = "white") +
  coord_flip() +
  xlab("Pizza Name\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Fat per Pizza Name (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Saturated Fat per pizza topping

```{r}
pizza_sat %>%
  ggplot() +
  aes(reorder(x = name, Saturated), y = Saturated) +
  geom_col(fill = "darkblue", col = "white") +
  coord_flip() +
  xlab("Pizza Name\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Saturated Fat per Pizza Name (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Carbs per Pizza Topping

```{r}
pizza_carbs %>%
  ggplot() +
  aes(reorder(x = name, Carbs), y = Carbs) +
  geom_col(fill = "darkblue", col = "white") +
  coord_flip() +
  xlab("Pizza Name\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Carbs per Pizza Name (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Sugar per Pizza Topping

```{r}
pizza_sugar %>%
  ggplot() +
  aes(reorder(x = name, Sugar), y = Sugar) +
  geom_col(fill = "darkblue", col = "white") +
  coord_flip() +
  xlab("Pizza Name\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Sugar per Pizza Name (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Fibre per Pizza Topping

```{r}
pizza_fibre %>%
  ggplot() +
  aes(reorder(x = name, Fibre), y = Fibre) +
  geom_col(fill = "darkblue", col = "white") +
  coord_flip() +
  xlab("Pizza Name\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Fibre per Pizza Name (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Salt per Pizza Topping

```{r}
pizza_salt %>%
  ggplot() +
  aes(reorder(x = name, Salt), y = Salt) +
  geom_col(fill = "darkblue", col = "white") +
  coord_flip() +
  xlab("Pizza Name\n") +
  ylab("\nRDA (%)") +
  ggtitle("%RDA of Salt per Pizza Name (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```






# Making a DF to be able to search for all %RDA obervations

```{r}
# Creating DF with macros for all toppings, crust types and sizes then pivot long

pizza_RDA_long <- pizza %>%
  select(name, crust, size, Calories, Protein, Fat, Saturated, Carbs, Sugar,
         Fibre, Salt) %>%
  group_by(name, crust, size) %>%
  pivot_longer(cols = c(Calories, Protein, Fat, Saturated, Carbs, Sugar, Fibre, 
                        Salt), 
               names_to = "Macros", 
               values_to = "Values")
```




