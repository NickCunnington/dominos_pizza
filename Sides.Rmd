---
title: "R Notebook"
output: html_notebook
---

```{r}
library(readxl)
library(janitor)
library(tidyverse)
```

```{r}
sides <- read_csv("clean_data/sides_clean.csv")
```



# Changing table format from wide to long to make it easier to plot data in groups


```{r}
# %RDA long table (+ removing duplicates of recipes)

sides_pivoted_RDA <- sides %>%
  select(dish, type, Calories, Fat, Saturated, Carbs, Sugar, Fibre, Protein, Salt, 
         Sodium) %>%
  filter(dish != "Spicy BBQ Wings (14)" & dish != "Frank's Red Hot Wings (14)" &
           dish != "Chicken Wings (14)" & dish!= "Chicken Strippers (14)" &
           dish != "Chicken Kickers (14)" & dish != "Pop'n Chicken Double Portion" &
           dish != "BBQ Dip 100g" & dish != "Frank's Hot Dip 100g" & 
           dish != "Garlic and Herb Dip 100g") %>% 
  pivot_longer(cols = c(Calories, Fat, Saturated, Carbs, Sugar, Fibre, Protein, 
                        Salt, Sodium), 
               names_to = "Macros", 
               values_to = "Values")
```


```{r}
# g per serving long table (+ removing duplicates of recipes) 

sides_pivoted_serv <- sides %>%
  select(dish, type, energy_kcal_serv, fat_g_serv, sat_g_serv, carb_g_serv, 
         sugars_g_serv, fibre_g_serv, protein_g_serv, salt_g_serv, sodium_g_serv) %>%
  filter(dish != "Spicy BBQ Wings (14)" & dish != "Frank's Red Hot Wings (14)" &
           dish != "Chicken Wings (14)" & dish!= "Chicken Strippers (14)" &
           dish != "Chicken Kickers (14)" & dish != "Pop'n Chicken Double Portion" &
           dish != "BBQ Dip 100g" & dish != "Frank's Hot Dip 100g" & 
           dish != "Garlic and Herb Dip 100g") %>% 
  pivot_longer(cols = c(energy_kcal_serv, fat_g_serv, sat_g_serv, carb_g_serv,
                        sugars_g_serv, fibre_g_serv, protein_g_serv, salt_g_serv,
                        sodium_g_serv),
               names_to = "Macros", 
               values_to = "Values")
```


```{r}
# per 100g long table (+ removing duplicates of recipes)

sides_pivoted_100g <- sides %>%
  select(dish, type, energy_kcal_100g, fat_g_100g, sat_g_100g, carb_g_100g, 
         sugars_g_100g, fibre_g_100g, protein_g_100g, salt_g_100g, sodium_g_100g) %>%
  filter(dish != "Spicy BBQ Wings (14)" & dish != "Frank's Red Hot Wings (14)" &
           dish != "Chicken Wings (14)" & dish!= "Chicken Strippers (14)" &
           dish != "Chicken Kickers (14)" & dish != "Pop'n Chicken Double Portion" &
           dish != "BBQ Dip 100g" & dish != "Frank's Hot Dip 100g" & 
           dish != "Garlic and Herb Dip 100g") %>% 
  pivot_longer(cols = c(energy_kcal_100g, fat_g_100g, sat_g_100g, carb_g_100g,
                        sugars_g_100g, fibre_g_100g, protein_g_100g, salt_g_100g,
                        sodium_g_100g),
               names_to = "Macros", 
               values_to = "Values")
  
```




# Exploring the Data


### Macros for sides per 100g


```{r}
sides_pivoted_100g %>%
  filter(Macros == "energy_kcal_100g") %>%
  group_by(dish) %>%
  summarise(calories_per_100g = Values)

```

```{r}
sides_pivoted_100g %>%
  filter(Macros == "energy_kcal_100g") %>%
  filter(type == "side") %>%
  ggplot() +
  aes(reorder(x = dish, Values), y = Values) +
  coord_flip() +
  geom_col(fill = "darkblue", col = "white") +
  xlab("Side Type\n") +
  ylab("\nCalories (kcal)") +
  ggtitle("Amount of calories per side type (per 100g)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```

*Although exploring this using values per 100g is a good way of normalising data for all the food types to a common baseline, it isn't really that easy for a person to immediately understand whether something is good or bad nutritionally, only how it compares to something else.  I shall therefore use the values per serving as a baseline.  And specifically use the percent of recommended daily allowance, rather than in grams, so it's easy to quickly judge the nutritional value of a dish compared to you RDA guidelines.*


# Using percentage of Recommended Daily Allowance (RDA) of macros



## Side Dishes


### %RDA Calories and Protein for Sides

```{r}
sides_pivoted_RDA %>%
  filter(type == "side") %>%
  filter(Macros == "Protein" | Macros =="Calories") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Calories and Protein for Side dishes (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Fat and Saturated Fat for sides

```{r}
sides_pivoted_RDA %>%
  filter(type == "side") %>%
  filter(Macros == "Fat" | Macros =="Saturated") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of non-sat Fat and Sat Fat for Side dishes (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Carbs and Sugars for sides

```{r}
sides_pivoted_RDA %>%
  filter(type == "side") %>%
  filter(Macros == "Carbs" | Macros =="Sugar") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Carbs and Sugar for Side dishes (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


# %RDA of Fibre and Salt for sides


```{r}
sides_pivoted_RDA %>%
  filter(type == "side") %>%
  filter(Macros == "Salt" | Macros =="Fibre") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Fibre and Salt for Side dishes (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


## Dips

### %RDA Calories and Protein for dips

```{r}
sides_pivoted_RDA %>%
  filter(type == "dip") %>%
  filter(Macros == "Protein" | Macros =="Calories") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Calories and Protein for Side dishes (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```

### %RDA Fat and Saturated Fat for dips

```{r}
sides_pivoted_RDA %>%
  filter(type == "dip") %>%
  filter(Macros == "Fat" | Macros =="Saturated") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of non-sat Fat and Saturated Fat for Dips (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Carbs and Sugar for dips


```{r}
sides_pivoted_RDA %>%
  filter(type == "dip") %>%
  filter(Macros == "Carbs" | Macros =="Sugar") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Carbs and Sugar for Dips (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Fibre and Salt for dips

```{r}
sides_pivoted_RDA %>%
  filter(type == "dip") %>%
  filter(Macros == "Salt" | Macros =="Fibre") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Fibre and Salt for Dips (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


## Wraps

### %RDA Calories and Protein for wraps

```{r}
sides_pivoted_RDA %>%
  filter(type == "wrapzz") %>%
  filter(Macros == "Protein" | Macros =="Calories") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Calories and Protein for Wraps (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA Fat and Sat for Wraps

```{r}
sides_pivoted_RDA %>%
  filter(type == "wrapzz") %>%
  filter(Macros == "Saturated" | Macros =="Fat") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of non-sat Fat and Sat Fat for Wraps (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```

# %RDA Carbs and Sugar

```{r}
sides_pivoted_RDA %>%
  filter(type == "wrapzz") %>%
  filter(Macros == "Carbs" | Macros =="Sugar") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Carbs and Sugar for Wraps (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```

### %RDA of Fibre and Salt for Wraps

```{r}
sides_pivoted_RDA %>%
  filter(type == "wrapzz") %>%
  filter(Macros == "Salt" | Macros =="Fibre") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Fibre and Salt for Wraps (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```





## Desserts

### %RDA Calories and Protein for desserts

```{r}
sides_pivoted_RDA %>%
  filter(type == "dessert") %>%
  filter(Macros == "Protein" | Macros =="Calories") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Calories and Protein for Desserts (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA of Fat and Sat for desserts

```{r}
sides_pivoted_RDA %>%
  filter(type == "dessert") %>%
  filter(Macros == "Fat" | Macros =="Saturated") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of non-sat Fat and Saturated Fat for Desserts (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```

### %RDA Carbs and Sugar for desserts

```{r}
sides_pivoted_RDA %>%
  filter(type == "dessert") %>%
  filter(Macros == "Carbs" | Macros =="Sugar") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Carbs and Sugar for Desserts (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```


### %RDA Fibre and Salt for desserts

```{r}
sides_pivoted_RDA %>%
  filter(type == "dessert") %>%
  filter(Macros == "Salt" | Macros =="Fibre") %>%
  ggplot() +
  aes(x = dish, y = Values, fill = Macros) +
  geom_col(position = "dodge") +
  coord_flip() +
  xlab("Side Type\n") +
  ylab("\nRDA (%)") +
  ggtitle("RDA of Fibre and Salt for Desserts (per serving)\n") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, size = 15, face = "bold")) +
  theme(axis.title.x = element_text(size = 14)) +
  theme(axis.title.y = element_text(size = 14))
```

